<!DOCTYPE html>
<html>
<head>
    <title>MusicFest ID Card</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Special+Gothic+Expanded+One&family=Prompt:wght@400;600;700&family=Doto&display=swap" rel="stylesheet">

    <style>
        /* Global Styles & Variables */
        :root {
            --blue-dark: #2657ab;
            --blue-light: #5773a1;
            --green-dark: #377253;
            --green-light: #457b61;
            --red-accent: #bb4237;
            --bg-cream: #dee0d1;
        }

        body { 
            font-family: 'Prompt', sans-serif; 
            padding: 20px; 
            display: flex; 
            gap: 40px; 
            background-color: #f0f0f0; 
        }

        /* UI Input Panel */
        .input-panel {
            width: 300px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        input { padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-family: 'Prompt', sans-serif; }
        .three-words-container { display: flex; gap: 5px; }
        .three-words-container input { width: 100%; }

        /* ID Card Base */
        #idCard {
            width: 600px;
            height: 380px;
            background-color: var(--bg-cream);
            border-radius: 40px;
            position: relative;
            overflow: hidden;
            box-sizing: border-box;
            display: flex; 
            flex-direction: column;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        /* Decorative Elements */
        .star {
            position: absolute;
            font-size: 220px;
            line-height: 1;
            filter: drop-shadow(6px 6px 0 rgba(255,255,255,0.35));
            z-index: 2;
        }

        .star-red { top: -40px; right: -20px; color: var(--red-accent); transform: rotate(15deg); z-index: 3; }
        .star-blue { bottom: -60px; left: 10px; font-size: 190px; color: var(--blue-light); transform: rotate(-10deg); }
        .star-green { top: -50px; left: -40px; font-size: 200px; color: var(--green-light); transform: rotate(-8deg); }

        /* Card Header Section */
        .header-bar {
            background-color: var(--green-dark);
            height: 85px;
            width: 100%;
            display: flex;
            align-items: center;
            padding: 0 30px;
            position: relative;   
            z-index: 3;
        }

        .header-text {
            font-family: 'Special Gothic Expanded One', sans-serif;
            font-size: 46px;
            font-weight: 900;
            letter-spacing: -1px;
            color: #000;
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        #sigSpace {
            border-bottom: 3px dotted #000;
            min-width: 120px;
            outline: none;
            text-transform: uppercase;
            font-size: 28px; 
            letter-spacing: 2px;
        }

        #headerDate {
            position: absolute;
            right: 75px;
            top: 50%;
            transform: translateY(-50%);
            max-width: 180px;
            overflow: hidden;
            text-overflow: ellipsis;
            font-family: 'Doto', monospace;
            font-size: 22px;
            letter-spacing: 2px;
            color: #eaeaea;
            white-space: nowrap;
            z-index: 10; 
        }

        /* Card Body & Information */
        .card-body {
            display: flex;
            padding: 20px 35px;
            gap: 30px;
            z-index: 3;
        }

        .photo-area {
            width: 170px;
            height: 170px;
            background-color: #fff;
            border: 6px solid #000;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            flex-shrink: 0;
            margin-top: 10px;
        }

        #photoPreview { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            object-position: center top; 
            display: none; 
        }

        .info-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            gap: 14px;
            margin-top: 10px;
        }

        .field-row {
            border-bottom: 2px dotted #333;
            padding-bottom: 6px;
            display: flex;
            align-items: baseline;
        }
        
        .field-label { font-weight: 600; margin-right: 8px; white-space: nowrap; font-size: 13px; letter-spacing: 0.5px; }
        .field-value { color: #000; font-family: monospace; font-size: 18px; font-weight: bold; }
        .dob { letter-spacing: 2px; }

        /* Card Footer Section */
        .footer-bar {
            background-color: var(--blue-dark);
            height: 50px;
            width: 100%;
            position: absolute;
            bottom: 0;
            z-index: 2;
        }

        .footer-text {
            position: absolute;
            bottom: 3px;
            right: 40px;
            font-size: 34px;
            letter-spacing: 3px;
            color: var(--bg-cream);
            z-index: 3;
            white-space: nowrap;
        }

        /* Controls */
        .btn-download {
            margin-top: 20px;
            padding: 12px;
            background-color: var(--blue-dark);
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
        }

        .sync-row { font-size: 14px; }
    </style>
</head>
<body>

    <div class="input-panel">
        <h3>ID Card Details</h3>
        
        <label>1. Photo:</label>
        <input type="file" id="imgInput" accept="image/*">

        <label>2. Name (Detail Section):</label>
        <input type="text" id="nameInput" placeholder="Enter Full Name" maxlength="24">

        <label class="sync-row">
            <input type="checkbox" id="syncSig" checked>
            Sync signature with name
        </label>

        <label>3. Born (DDMMYYYY):</label>
        <input type="text" id="dobInput" placeholder="Type numbers only" maxlength="10">

        <label>4. 3 Cool Words:</label>
        <div class="three-words-container">
            <input type="text" id="w1Input" placeholder="Word 1">
            <input type="text" id="w2Input" placeholder="Word 2">
            <input type="text" id="w3Input" placeholder="Word 3">
        </div>

        <label>5. Music:</label>
        <input type="text" id="bandInput" placeholder="Favorite Band">
        <input type="text" id="songInput" placeholder="Favorite Song">

        <button class="btn-download" onclick="downloadCard()">Download Card</button>
    </div>

    <div id="idCard">
        <div class="star star-green">★</div>
        <div class="star star-red">★</div>
        <div class="star star-blue">★</div>

        <div class="header-bar">
            <div class="header-text">
                I<span id="sigSpace" contenteditable="true">......</span>Card
            </div>
            <div id="headerDate">13 FEB 2026</div>
        </div>
        
        <div class="card-body">
            <div class="photo-area">
                <img id="photoPreview" src="">
                <span id="photoPlaceholder">No Photo</span>
            </div>

            <div class="info-area">
                <div class="field-row">
                    <span class="field-label">มายเนม อีส:</span>
                    <span class="field-value" id="dispName"></span>
                </div>

                <div class="field-row">
                    <span class="field-label">วันที่คลอด:</span>
                    <span class="field-value dob" id="dispDob"></span>
                </div>

                <div class="field-row">
                    <span class="field-label">3 คำ เด็ด:</span>
                    <span class="field-value">
                        <span id="dispW1"></span> / <span id="dispW2"></span> / <span id="dispW3"></span>
                    </span>
                </div>

                <div class="field-row">
                    <span class="field-label">วงที่ชอบ:</span>
                    <span class="field-value" id="dispBand"></span>
                </div>

                <div class="field-row">
                    <span class="field-label">เพลงโปรด:</span>
                    <span class="field-value" id="dispSong"></span>
                </div>
            </div>
        </div>

        <div class="footer-text" id="footerText">&nbsp;ยัง&nbsp;อยู่</div>
        <div class="footer-bar"></div>
    </div>

    <script>
        /* Initialization & Input Mapping */
        function mapInput(inputId, displayId) {
            document.getElementById(inputId).addEventListener('input', (e) => {
                document.getElementById(displayId).innerText = e.target.value;
            });
        }
        
        mapInput('nameInput', 'dispName');
        mapInput('bandInput', 'dispBand');
        mapInput('songInput', 'dispSong');
        mapInput('w1Input', 'dispW1');
        mapInput('w2Input', 'dispW2');
        mapInput('w3Input', 'dispW3');

        const sigSpace = document.getElementById('sigSpace');
        const nameInput = document.getElementById('nameInput');
        const syncSig = document.getElementById('syncSig');
        const footerText = document.getElementById('footerText');

        /* Footer & Name Logic */
        function updateFooterText(fullName) {
            const parts = fullName.trim().split(/\s+/);
            if (parts.length >= 2) {
                footerText.innerText = `${parts[0]} ยัง ${parts.slice(1).join(' ')} อยู่`;
            } else if (parts.length === 1 && parts[0] !== '') {
                footerText.innerText = `${parts[0]} ยัง อยู่`;
            } else {
                footerText.innerHTML = '&nbsp;ยัง&nbsp;อยู่';
            }
        }

        nameInput.addEventListener('input', () => {
            if (syncSig.checked) {
                sigSpace.innerText = nameInput.value || '......';
            }
            updateFooterText(nameInput.value);
        });

        sigSpace.addEventListener('input', () => {
            if (syncSig.checked) syncSig.checked = false;
        });

        sigSpace.addEventListener('blur', () => {
            if (sigSpace.innerText.trim() === '') sigSpace.innerText = '......';
        });

        /* Media Handling */
        document.getElementById('imgInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = document.getElementById('photoPreview');
                    img.src = event.target.result;
                    img.style.display = 'block';
                    document.getElementById('photoPlaceholder').style.display = 'none';
                }
                reader.readAsDataURL(file);
            }
        });

        /* Data Formatting */
        document.getElementById('dobInput').addEventListener('input', function(e) {
            let val = e.target.value.replace(/\D/g, '');
            if (val.length > 8) val = val.substring(0, 8);
            let out = val;
            if (val.length > 4) out = val.slice(0, 2) + '/' + val.slice(2, 4) + '/' + val.slice(4);
            else if (val.length > 2) out = val.slice(0, 2) + '/' + val.slice(2);
            e.target.value = out;
            document.getElementById('dispDob').innerText = out;
        });

        /* Image Generation */
        function downloadCard() {
            const dispName = document.getElementById('dispName');
            if (!dispName.innerText.trim()) {
                alert('Please enter a name first.');
                return;
            }

            html2canvas(document.getElementById('idCard'), {
                scale: 2,
                useCORS: true,
                backgroundColor: null
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'MusicFest-ID.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        }
    </script>
</body>
</html>
